parameters:
  - name: shouldPublish # name of the parameter; required
    type: boolean # data type of the parameter; required

steps:
  - bash: |
      echo "creating pre-bump version snapshot"
      node common/scripts/install-run-rush.js list --json > "$(Agent.TempDirectory)/versions-before.txt"

      echo "bumping versions"
      node common/scripts/install-run-rush.js version --bump

      echo "creating post-bump version snapshot"
      node common/scripts/install-run-rush.js list --json > "$(Agent.TempDirectory)/versions-after.txt"

      # Next version dance
      node common/scripts/handleNextVersion.js "$(Agent.TempDirectory)/versions-before.txt" "$(Agent.TempDirectory)/versions-after.txt"
    displayName: Add Release Notes
    name: releaseNotes
    condition: and(succeeded(), eq(variables['Agent.OS'], 'Windows_NT'), ${{ parameters.shouldPublish }} )
